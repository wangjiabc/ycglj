<!doctype html>
<html>

<head>
  <meta charset="utf-8">
  <title>案件列表</title>
  <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no,minimal-ui" />

  <script src="/ycglj/js/jquery.min.js"></script>
  <!--jquery weui-->
  <link rel="stylesheet" href="https://cdn.bootcss.com/weui/1.1.3/style/weui.min.css">
  <link rel="stylesheet" href="https://cdn.bootcss.com/jquery-weui/1.2.1/css/jquery-weui.min.css">

  <script type="text/javascript" src="/ycglj/mobile/singleton.js"></script>

  <script type="text/javascript">
    var redirectUrl = "https://open.weixin.qq.com/connect/oauth2/authorize?appid=" + APPID + "&redirect_uri=" + DOMAIN + "/ycglj/mobile/asset/index.html&response_type=code&scope=snsapi_base&state=STATE#wechat_redirect";
  </script>

  <script src="https://res.wx.qq.com/open/js/jweixin-1.2.0.js"></script>
</head>
<style>
  .record{
    width:100%;
    height:auto;
}
.weui-label{
  width:55px;
}
.button_sp_area{
  margin: 10px;
  position: fixed;
  bottom: 5px;
  right:5px;
}
</style>

<body>
  <div class="weui-search-bar" id="searchBar">
    <form class="weui-search-bar__form">
      <div class="weui-search-bar__box">
        <i class="weui-icon-search"></i>
        <input type="search" class="weui-search-bar__input" id="searchInput" placeholder="搜索" required="">
        <a href="javascript:" class="weui-icon-clear" id="searchClear"></a>
      </div>
      <label class="weui-search-bar__label" id="searchText">
        <i class="weui-icon-search"></i>
        <span>搜索名字或距离</span>
      </label>
    </form>
    <a href="javascript:" class="weui-search-bar__cancel-btn" id="searchCancel">取消</a>
  </div>
  <div id='listwrap'>
    <!-- body 顶部加上如下代码 -->
    <div class="weui-pull-to-refresh__layer">
      <div class='weui-pull-to-refresh__arrow'></div>
      <div class='weui-pull-to-refresh__preloader'></div>
      <div class="down">下拉刷新</div>
      <div class="up">释放刷新</div>
      <div class="refresh">正在刷新</div>
    </div>

    <div class="weui-panel weui-panel_access">
      <div class="weui-panel__hd">零售商户</div>
      <div class="weui-panel__bd">
      </div>
    </div>
  </div>
  <script src="https://cdn.bootcss.com/jquery/1.11.2/jquery.min.js"></script>
  <script src="https://cdn.bootcss.com/jquery-weui/1.2.1/js/jquery-weui.min.js"></script>
  <script src="https://cdn.bootcss.com/fastclick/1.0.6/fastclick.js"></script>
  <script>
    $(function () {
      FastClick.attach(document.body);
    });
  </script>
  <script>
    var html = '';
    init();
    $('#listwrap').pullToRefresh(function () {
      init();
    });

    //加载列表数据
    function caseDom(data) {
      for (let index = 0; index < data.case_cells.length; index++) {
        html += '<a href="javascript:void(0);" class="weui-media-box weui-media-box_appmsg">' +
          '<div class="weui-media-box__hd">' +
          '<img class="weui-media-box__thumb" src="">' +
          '</div>' +
          '<div class="weui-media-box__bd">' +
          '<h3 class="weui-media-box__title">姓名:' + data.case_cells[index].name + '</h3>' +
          '<p class="weui-media-box__desc">许可证号:' + data.case_cells[index].license + '</p>' +
          '<p class="weui-media-box__desc">距离' + data.case_cells[index].distance + '</p>' +
          '<p class="weui-media-box__desc">地址' + data.case_cells[index].address + '</p>' +
          '</div>' +
          '</a>';
      }
    }
    //初始化列表数据
    function init() {
      $.ajax({
        type: "get",
        url: 'http://doc.88hao.cn/mock/27/',
        dataType: "json",
        contentType: 'application/x-www-form-urlencoded;charset=utf-8',
        success: function (data) {
          caseDom(data);
          $('.weui-panel__bd').append(html);
          $('.weui-panel weui-panel_access').pullToRefreshDone();
        },
        error: function (error) {
          console.log(error);
        }
      })
    }
  </script>
</body>

</html>